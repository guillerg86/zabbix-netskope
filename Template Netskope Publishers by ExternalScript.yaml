zabbix_export:
  version: '7.2'
  template_groups:
    - uuid: 1e2c2c2f2e224c51a2ee64d422aeb4b4
      name: Templates/SaaS
  host_groups:
    - uuid: f20e18dd45d24fdeb7878f8c79a35f7e
      name: Netskope
  templates:
    - uuid: bddf9bf51b2f452483fd25355a6cb4e2
      template: 'Template Netskope Publisher Host by ExternalScript'
      name: 'Template Netskope Publisher Host by ExternalScript'
      description: |
        Template for Netskope Publishers using API Rest V2
        
        @author: Guille Rodriguez Gonzalez 
        @github: https://github.com/guillerg86/
        @linkedin: www.linkedin.com/in/guille-rodriguez-gonzalez
      groups:
        - name: Templates/SaaS
      items:
        - uuid: 02870171c7b1439aa4d164f7960928b3
          name: 'Autoupgrade enabled'
          type: DEPENDENT
          key: netskope.infra.publisher.autoupgrade_enabled
          history: 7d
          valuemap:
            name: True-False
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.capabilities.DTLS
            - type: BOOL_TO_DECIMAL
          master_item:
            key: 'zabbix_netskope_publishers.py[-a,"get-publisher",-pid,{$NETSKOPE.PUBLISHER.ID},-au,"{$NETSKOPE.TENANTURL}",-ak,"{$NETSKOPE.APITOKEN}"]'
          triggers:
            - uuid: b40a0352739f477095c5e5037faa753c
              expression: 'change(/Template Netskope Publisher Host by ExternalScript/netskope.infra.publisher.autoupgrade_enabled)<>0'
              recovery_mode: NONE
              name: 'Autoupgrade changed'
              opdata: 'status: {ITEM.LASTVALUE}'
              priority: WARNING
              type: MULTIPLE
              manual_close: 'YES'
        - uuid: 764542e0b9cf48b0a95ee7050f3d5143
          name: 'DTLS support'
          type: DEPENDENT
          key: netskope.infra.publisher.DTLS
          history: 7d
          valuemap:
            name: True-False
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.capabilities.DTLS
            - type: BOOL_TO_DECIMAL
          master_item:
            key: 'zabbix_netskope_publishers.py[-a,"get-publisher",-pid,{$NETSKOPE.PUBLISHER.ID},-au,"{$NETSKOPE.TENANTURL}",-ak,"{$NETSKOPE.APITOKEN}"]'
          triggers:
            - uuid: fabf85e74521491bbe6c68e2c7b9e2f1
              expression: 'change(/Template Netskope Publisher Host by ExternalScript/netskope.infra.publisher.DTLS)<>0'
              recovery_mode: NONE
              name: 'DTLS Support changed'
              opdata: 'status: {ITEM.LASTVALUE}'
              priority: INFO
              type: MULTIPLE
              manual_close: 'YES'
        - uuid: 376c30e5f05f46f4833f441c817c5332
          name: 'EEE Support'
          type: DEPENDENT
          key: netskope.infra.publisher.EEE
          history: 7d
          valuemap:
            name: True-False
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.capabilities.EEE
            - type: BOOL_TO_DECIMAL
          master_item:
            key: 'zabbix_netskope_publishers.py[-a,"get-publisher",-pid,{$NETSKOPE.PUBLISHER.ID},-au,"{$NETSKOPE.TENANTURL}",-ak,"{$NETSKOPE.APITOKEN}"]'
          triggers:
            - uuid: 8edd0302763d41e69306bc459fc79b14
              expression: 'change(/Template Netskope Publisher Host by ExternalScript/netskope.infra.publisher.EEE)<>0'
              recovery_mode: NONE
              name: 'EEE Support changed'
              opdata: 'status: {ITEM.LASTVALUE}'
              priority: INFO
              type: MULTIPLE
              manual_close: 'YES'
        - uuid: 3b1146f455564d2bab5fd114584029c0
          name: 'IP Address'
          type: DEPENDENT
          key: netskope.infra.publisher.ip_address
          value_type: CHAR
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.assessment.ip_address
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 24h
          master_item:
            key: 'zabbix_netskope_publishers.py[-a,"get-publisher",-pid,{$NETSKOPE.PUBLISHER.ID},-au,"{$NETSKOPE.TENANTURL}",-ak,"{$NETSKOPE.APITOKEN}"]'
          triggers:
            - uuid: 8f199242c6a54d12939069270dc9ad9c
              expression: 'change(/Template Netskope Publisher Host by ExternalScript/netskope.infra.publisher.ip_address)<>0'
              recovery_mode: NONE
              name: 'IP Address changed'
              opdata: 'status: {ITEM.LASTVALUE}'
              priority: INFO
              type: MULTIPLE
              manual_close: 'YES'
        - uuid: c501de9dc8a446569aa29611eaaf6071
          name: Latency
          type: DEPENDENT
          key: netskope.infra.publisher.latency
          history: 7d
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.assessment.latency
          master_item:
            key: 'zabbix_netskope_publishers.py[-a,"get-publisher",-pid,{$NETSKOPE.PUBLISHER.ID},-au,"{$NETSKOPE.TENANTURL}",-ak,"{$NETSKOPE.APITOKEN}"]'
          triggers:
            - uuid: 20a0fe24abae46288ad5ee9b64fb5e40
              expression: 'avg(/Template Netskope Publisher Host by ExternalScript/netskope.infra.publisher.latency,5m)>{$NETSKOPE.PUBLISHER.LATENCY.WARNING_TRIGGER}'
              name: 'Latency is high'
              opdata: 'latency: {ITEM.LASTVALUE}'
              priority: WARNING
              manual_close: 'YES'
        - uuid: 0066816eeb1a451d8fa73a4a0304e15a
          name: 'Local Broker Connect'
          type: DEPENDENT
          key: netskope.infra.publisher.lbrokerconnect
          history: 7d
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.lbrokerconnect
            - type: BOOL_TO_DECIMAL
          master_item:
            key: 'zabbix_netskope_publishers.py[-a,"get-publisher",-pid,{$NETSKOPE.PUBLISHER.ID},-au,"{$NETSKOPE.TENANTURL}",-ak,"{$NETSKOPE.APITOKEN}"]'
        - uuid: 3be81d890bd040ffa783d5c48cf82632
          name: Name
          type: DEPENDENT
          key: netskope.infra.publisher.name
          value_type: CHAR
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.publisher_name
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 4h
          master_item:
            key: 'zabbix_netskope_publishers.py[-a,"get-publisher",-pid,{$NETSKOPE.PUBLISHER.ID},-au,"{$NETSKOPE.TENANTURL}",-ak,"{$NETSKOPE.APITOKEN}"]'
        - uuid: 6d8ea935d03545f0942e09c9f895c8e1
          name: 'NewEdge Wan Architecture BA'
          type: DEPENDENT
          key: netskope.infra.publisher.nwa_ba
          history: 7d
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.capabilities.nwa_ba
            - type: BOOL_TO_DECIMAL
          master_item:
            key: 'zabbix_netskope_publishers.py[-a,"get-publisher",-pid,{$NETSKOPE.PUBLISHER.ID},-au,"{$NETSKOPE.TENANTURL}",-ak,"{$NETSKOPE.APITOKEN}"]'
        - uuid: 0d98f6796ba14c88bd08919ff008e7d7
          name: Registered
          type: DEPENDENT
          key: netskope.infra.publisher.registered
          history: 7d
          valuemap:
            name: True-False
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.registered
            - type: BOOL_TO_DECIMAL
          master_item:
            key: 'zabbix_netskope_publishers.py[-a,"get-publisher",-pid,{$NETSKOPE.PUBLISHER.ID},-au,"{$NETSKOPE.TENANTURL}",-ak,"{$NETSKOPE.APITOKEN}"]'
        - uuid: 625abdab0ef344fb9fcba02315efc38e
          name: Status
          type: DEPENDENT
          key: netskope.infra.publisher.status
          value_type: CHAR
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.status
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 4h
          master_item:
            key: 'zabbix_netskope_publishers.py[-a,"get-publisher",-pid,{$NETSKOPE.PUBLISHER.ID},-au,"{$NETSKOPE.TENANTURL}",-ak,"{$NETSKOPE.APITOKEN}"]'
          triggers:
            - uuid: 7799e33d5f60437abc64528ca5fd88ba
              expression: 'last(/Template Netskope Publisher Host by ExternalScript/netskope.infra.publisher.status)<>"connected" and last(/Template Netskope Publisher Host by ExternalScript/netskope.infra.publisher.status)<>"updating"'
              name: 'Not connected'
              opdata: 'status: {ITEM.LASTVALUE}'
              priority: HIGH
            - uuid: ec80d8f5f5b2472f993813d4d660955e
              expression: 'last(/Template Netskope Publisher Host by ExternalScript/netskope.infra.publisher.status)="updating"'
              name: Updating
              priority: INFO
        - uuid: 06e7370bb13f4676a71716f99d8b837b
          name: 'Stitcher POP'
          type: DEPENDENT
          key: netskope.infra.publisher.stitcher_pop
          value_type: CHAR
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.stitcher_pop
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 24h
          master_item:
            key: 'zabbix_netskope_publishers.py[-a,"get-publisher",-pid,{$NETSKOPE.PUBLISHER.ID},-au,"{$NETSKOPE.TENANTURL}",-ak,"{$NETSKOPE.APITOKEN}"]'
        - uuid: 4a7c0c12f1534a4ab269f13985996218
          name: 'Upgrade error code'
          type: DEPENDENT
          key: netskope.infra.publisher.upgrade_error_code
          history: 7d
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.upgrade_failed_reason.error_code
          master_item:
            key: 'zabbix_netskope_publishers.py[-a,"get-publisher",-pid,{$NETSKOPE.PUBLISHER.ID},-au,"{$NETSKOPE.TENANTURL}",-ak,"{$NETSKOPE.APITOKEN}"]'
          triggers:
            - uuid: a7dd235fb47f467f87ba88b5bc029d0e
              expression: 'last(/Template Netskope Publisher Host by ExternalScript/netskope.infra.publisher.upgrade_error_code)<>0'
              name: 'Upgrade error'
              priority: WARNING
        - uuid: e1f8dfa54d844b08a8656b87902407c9
          name: 'Upgrade error detail'
          type: DEPENDENT
          key: netskope.infra.publisher.upgrade_error_detail
          value_type: CHAR
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.upgrade_failed_reason.detail
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 24h
          master_item:
            key: 'zabbix_netskope_publishers.py[-a,"get-publisher",-pid,{$NETSKOPE.PUBLISHER.ID},-au,"{$NETSKOPE.TENANTURL}",-ak,"{$NETSKOPE.APITOKEN}"]'
        - uuid: d3242a9b076c48f6bd57c33cb9c3e2ed
          name: 'Upgrade requested'
          type: DEPENDENT
          key: netskope.infra.publisher.upgrade_request
          history: 7d
          valuemap:
            name: True-False
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.upgrade_request
            - type: BOOL_TO_DECIMAL
          master_item:
            key: 'zabbix_netskope_publishers.py[-a,"get-publisher",-pid,{$NETSKOPE.PUBLISHER.ID},-au,"{$NETSKOPE.TENANTURL}",-ak,"{$NETSKOPE.APITOKEN}"]'
        - uuid: 0d440fbb446a4d9f8b48f7cbfc6a710c
          name: 'Upgrade status'
          type: DEPENDENT
          key: netskope.infra.publisher.upgrade_status
          value_type: CHAR
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.upgrade_status.upstat
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 24h
          master_item:
            key: 'zabbix_netskope_publishers.py[-a,"get-publisher",-pid,{$NETSKOPE.PUBLISHER.ID},-au,"{$NETSKOPE.TENANTURL}",-ak,"{$NETSKOPE.APITOKEN}"]'
        - uuid: c5769239b6a64bba898620480c4d3bb1
          name: Version
          type: DEPENDENT
          key: netskope.infra.publisher.version
          value_type: CHAR
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.assessment.version
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 24h
          master_item:
            key: 'zabbix_netskope_publishers.py[-a,"get-publisher",-pid,{$NETSKOPE.PUBLISHER.ID},-au,"{$NETSKOPE.TENANTURL}",-ak,"{$NETSKOPE.APITOKEN}"]'
        - uuid: ed70d19b79cd4d32b5f05e2f87094cb6
          name: 'Version (float)'
          type: DEPENDENT
          key: netskope.infra.publisher.version_float
          history: 7d
          value_type: FLOAT
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.assessment.version
            - type: JAVASCRIPT
              parameters:
                - |
                  var data = value.split(".")
                  var version = data.shift()+"."+data.join('')
                  return version
          master_item:
            key: 'zabbix_netskope_publishers.py[-a,"get-publisher",-pid,{$NETSKOPE.PUBLISHER.ID},-au,"{$NETSKOPE.TENANTURL}",-ak,"{$NETSKOPE.APITOKEN}"]'
          triggers:
            - uuid: d587095f1f4042d58be20a630fc31b27
              expression: 'last(/Template Netskope Publisher Host by ExternalScript/netskope.infra.publisher.version_float)<"<{$NETSKOPE.PUBLISHER.MIN_VERSION}"'
              name: 'Outdated (min version accepted v{$NETSKOPE.PUBLISHER.MIN_VERSION})'
              priority: WARNING
        - uuid: b2377247f66b4efcb152e81af08166ed
          name: 'Raw data'
          type: EXTERNAL
          key: 'zabbix_netskope_publishers.py[-a,"get-publisher",-pid,{$NETSKOPE.PUBLISHER.ID},-au,"{$NETSKOPE.TENANTURL}",-ak,"{$NETSKOPE.APITOKEN}"]'
          history: '0'
          value_type: TEXT
          description: 'Request for get data for the publisher {#NETSKOPE.PUBLISHER.NAME}'
          timeout: 10s
          triggers:
            - uuid: 064084e817ac46c08495a5654895fa3a
              expression: 'nodata(/Template Netskope Publisher Host by ExternalScript/zabbix_netskope_publishers.py[-a,"get-publisher",-pid,{$NETSKOPE.PUBLISHER.ID},-au,"{$NETSKOPE.TENANTURL}",-ak,"{$NETSKOPE.APITOKEN}"],10m)=1'
              name: 'No data on last 10m'
              priority: DISASTER
      dashboards:
        - uuid: 9245240a15784a56879492d8b7f10bdc
          name: PublisherInfo
          pages:
            - widgets:
                - type: item
                  name: Name
                  width: '17'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: INTEGER
                      name: decimal_size
                      value: '40'
                    - type: STRING
                      name: description
                      value: Name
                    - type: INTEGER
                      name: desc_bold
                      value: '1'
                    - type: INTEGER
                      name: desc_size
                      value: '20'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Template Netskope Publisher Host by ExternalScript'
                        key: netskope.infra.publisher.name
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '40'
                - type: item
                  name: 'Local IP Address'
                  'y': '2'
                  width: '17'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: INTEGER
                      name: decimal_size
                      value: '40'
                    - type: STRING
                      name: description
                      value: 'Local IP Address'
                    - type: INTEGER
                      name: desc_bold
                      value: '1'
                    - type: INTEGER
                      name: desc_size
                      value: '20'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Template Netskope Publisher Host by ExternalScript'
                        key: netskope.infra.publisher.ip_address
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '40'
                - type: item
                  name: Version
                  'y': '4'
                  width: '17'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: INTEGER
                      name: decimal_size
                      value: '40'
                    - type: STRING
                      name: description
                      value: Version
                    - type: INTEGER
                      name: desc_bold
                      value: '1'
                    - type: INTEGER
                      name: desc_size
                      value: '20'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Template Netskope Publisher Host by ExternalScript'
                        key: netskope.infra.publisher.version
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '40'
                - type: item
                  name: 'Stitcher POP'
                  'y': '6'
                  width: '17'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: INTEGER
                      name: decimal_size
                      value: '40'
                    - type: STRING
                      name: description
                      value: 'Stitcher POP'
                    - type: INTEGER
                      name: desc_bold
                      value: '1'
                    - type: INTEGER
                      name: desc_size
                      value: '20'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Template Netskope Publisher Host by ExternalScript'
                        key: netskope.infra.publisher.stitcher_pop
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '40'
                - type: svggraph
                  name: 'Latency (ms)'
                  x: '17'
                  width: '55'
                  height: '4'
                  fields:
                    - type: INTEGER
                      name: ds.0.approximation
                      value: '4'
                    - type: STRING
                      name: ds.0.color
                      value: FF465C
                    - type: STRING
                      name: ds.0.items.0
                      value: Latency
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: HAEXA
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: item
                  name: Status
                  x: '17'
                  'y': '4'
                  width: '12'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: INTEGER
                      name: decimal_size
                      value: '40'
                    - type: STRING
                      name: description
                      value: Status
                    - type: INTEGER
                      name: desc_bold
                      value: '1'
                    - type: INTEGER
                      name: desc_size
                      value: '20'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Template Netskope Publisher Host by ExternalScript'
                        key: netskope.infra.publisher.status
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '40'
                - type: item
                  name: Registered
                  x: '17'
                  'y': '6'
                  width: '12'
                  hide_header: 'YES'
                  fields:
                    - type: STRING
                      name: bg_color
                      value: FFCA28
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: INTEGER
                      name: decimal_size
                      value: '40'
                    - type: STRING
                      name: description
                      value: Registered
                    - type: INTEGER
                      name: desc_bold
                      value: '1'
                    - type: INTEGER
                      name: desc_size
                      value: '20'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Template Netskope Publisher Host by ExternalScript'
                        key: netskope.infra.publisher.registered
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: STRING
                      name: thresholds.0.color
                      value: E65660
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: 0EC9AC
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '1'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '40'
                - type: item
                  name: 'Upgrade status'
                  x: '29'
                  'y': '4'
                  width: '11'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: INTEGER
                      name: decimal_size
                      value: '40'
                    - type: STRING
                      name: description
                      value: 'Upgrade status'
                    - type: INTEGER
                      name: desc_bold
                      value: '1'
                    - type: INTEGER
                      name: desc_size
                      value: '20'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Template Netskope Publisher Host by ExternalScript'
                        key: netskope.infra.publisher.upgrade_status
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '40'
                - type: item
                  name: Error
                  x: '29'
                  'y': '6'
                  width: '11'
                  hide_header: 'YES'
                  fields:
                    - type: STRING
                      name: bg_color
                      value: FFCA28
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: INTEGER
                      name: decimal_size
                      value: '40'
                    - type: STRING
                      name: description
                      value: 'Upgrade error code'
                    - type: INTEGER
                      name: desc_bold
                      value: '1'
                    - type: INTEGER
                      name: desc_size
                      value: '20'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Template Netskope Publisher Host by ExternalScript'
                        key: netskope.infra.publisher.upgrade_error_code
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: STRING
                      name: thresholds.0.color
                      value: 0EC9AC
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: E65660
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '1'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '40'
                - type: item
                  name: 'Autoupgrade enabled'
                  x: '40'
                  'y': '4'
                  width: '12'
                  hide_header: 'YES'
                  fields:
                    - type: STRING
                      name: bg_color
                      value: FFCA28
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: INTEGER
                      name: decimal_size
                      value: '40'
                    - type: STRING
                      name: description
                      value: 'Autoupgrade enabled'
                    - type: INTEGER
                      name: desc_bold
                      value: '1'
                    - type: INTEGER
                      name: desc_size
                      value: '20'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Template Netskope Publisher Host by ExternalScript'
                        key: netskope.infra.publisher.autoupgrade_enabled
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: STRING
                      name: thresholds.0.color
                      value: E65660
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: 0EC9AC
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '1'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '40'
                - type: item
                  name: 'Upgrade error message'
                  x: '40'
                  'y': '6'
                  width: '32'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: INTEGER
                      name: decimal_size
                      value: '40'
                    - type: STRING
                      name: description
                      value: 'Upgrade error details'
                    - type: INTEGER
                      name: desc_bold
                      value: '1'
                    - type: INTEGER
                      name: desc_size
                      value: '20'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Template Netskope Publisher Host by ExternalScript'
                        key: netskope.infra.publisher.upgrade_error_detail
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '40'
                - type: item
                  name: 'DTLS Support'
                  x: '52'
                  'y': '4'
                  width: '10'
                  hide_header: 'YES'
                  fields:
                    - type: STRING
                      name: bg_color
                      value: FFCA28
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: INTEGER
                      name: decimal_size
                      value: '40'
                    - type: STRING
                      name: description
                      value: 'DTLS Support'
                    - type: INTEGER
                      name: desc_bold
                      value: '1'
                    - type: INTEGER
                      name: desc_size
                      value: '20'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Template Netskope Publisher Host by ExternalScript'
                        key: netskope.infra.publisher.DTLS
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: STRING
                      name: thresholds.0.color
                      value: E65660
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: 0EC9AC
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '1'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '40'
                - type: item
                  name: 'EEE Support'
                  x: '62'
                  'y': '4'
                  width: '10'
                  hide_header: 'YES'
                  fields:
                    - type: STRING
                      name: bg_color
                      value: FFCA28
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: INTEGER
                      name: decimal_size
                      value: '40'
                    - type: STRING
                      name: description
                      value: 'EEE Support'
                    - type: INTEGER
                      name: desc_bold
                      value: '1'
                    - type: INTEGER
                      name: desc_size
                      value: '20'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Template Netskope Publisher Host by ExternalScript'
                        key: netskope.infra.publisher.EEE
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: STRING
                      name: thresholds.0.color
                      value: E65660
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: 0EC9AC
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '1'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '40'
      valuemaps:
        - uuid: 80efab7e98f04f7aae74672e64587307
          name: True-False
          mappings:
            - value: '0'
              newvalue: 'False'
            - value: '1'
              newvalue: 'True'
    - uuid: 40fc418382e24f749a516d30781bc7de
      template: 'Template Netskope Publishers by ExternalScript MultiHost'
      name: 'Template Netskope Publishers by ExternalScript MultiHost'
      description: |
        Template for Netskope Publishers using API Rest V2
        
        @author: Guille Rodriguez Gonzalez 
        @github: https://github.com/guillerg86/
        @linkedin: www.linkedin.com/in/guille-rodriguez-gonzalez
        
        Avoids the API Limit error
      groups:
        - name: Templates/SaaS
      items:
        - uuid: d6526373747b4ad9a4c27b5b7d63cb91
          name: 'Publishers file generated'
          type: EXTERNAL
          key: 'zabbix_netskope_publishers.py[-a,"get-publishers",-au,"{$NETSKOPE.TENANTURL}",-ak,"{$NETSKOPE.APITOKEN}"]'
          history: 1h
          triggers:
            - uuid: 81d58850bb4b435ba2172e7c0aafea35
              expression: 'nodata(/Template Netskope Publishers by ExternalScript MultiHost/zabbix_netskope_publishers.py[-a,"get-publishers",-au,"{$NETSKOPE.TENANTURL}",-ak,"{$NETSKOPE.APITOKEN}"],5m)=1'
              name: 'No file generated for more than 5m'
              priority: DISASTER
      discovery_rules:
        - uuid: 39524b06522f47fe9fdbae484448ed55
          name: 'Netskope Publisher Discovery'
          type: HTTP_AGENT
          key: netskope.infra.publisher.discovery
          delay: 1h
          enabled_lifetime_type: DISABLE_AFTER
          enabled_lifetime: 6h
          description: 'Get all Publishers for Netskope Tenant'
          host_prototypes:
            - uuid: 8af928e97ab6476c8a19acecc5cb3c31
              host: 'Netskope Publisher {#NETSKOPE.PUBLISHER.NAME}'
              name: 'Netskope Publisher {#NETSKOPE.PUBLISHER.NAME}'
              group_links:
                - group:
                    name: Netskope
              templates:
                - name: 'Template Netskope Publisher Host by ExternalScript'
              macros:
                - macro: '{$NETSKOPE.PUBLISHER.ID}'
                  value: '{#NETSKOPE.PUBLISHER.ID}'
              custom_interfaces: 'YES'
              interfaces:
                - {  }
          timeout: 10s
          url: '{$NETSKOPE.TENANTURL}/api/v2/infrastructure/publishers'
          headers:
            - name: Netskope-Api-Token
              value: '{$NETSKOPE.APITOKEN}'
          lld_macro_paths:
            - lld_macro: '{#NETSKOPE.PUBLISHER.ID}'
              path: $.publisher_id
            - lld_macro: '{#NETSKOPE.PUBLISHER.NAME}'
              path: $.publisher_name
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.data.publishers
      macros:
        - macro: '{$NETSKOPE.APITOKEN}'
          description: 'Netskope Token'
        - macro: '{$NETSKOPE.FOLDER_TMP}'
          value: /tmp/z
          description: 'Folder where temporary save the results of query'
        - macro: '{$NETSKOPE.PUBLISHER.LATENCY.WARNING_TRIGGER}'
          value: '80'
          description: 'Value over it''s considered warning latency'
        - macro: '{$NETSKOPE.PUBLISHER.MIN_VERSION}'
          value: '120'
          description: 'Minimum version of Publishers'
        - macro: '{$NETSKOPE.TENANTURL}'
          description: 'https://mytenant.eu.goskope.com'
      valuemaps:
        - uuid: b43e1d28336940b3bf36e5d7d92cbcd0
          name: 'Publisher Upgrade Error'
          mappings:
            - value: '0'
              newvalue: NoError
            - value: '770'
              newvalue: 'Newly downloaded version is the same'
        - uuid: b006881647e64ba69347bc178cafbcc9
          name: True-False
          mappings:
            - value: '1'
              newvalue: 'True'
            - value: '0'
              newvalue: 'False'
